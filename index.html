<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>Mine City - Image System</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; background-color: #1a1a1a; color: white; margin: 0; padding: 20px; }
        .card { background-color: #2d2d2d; padding: 2.5rem; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); text-align: center; width: 400px; }
        h2 { color: #4CAF50; margin-bottom: 5px; }
        .sub-title { color: #aaa; font-size: 0.9rem; margin-bottom: 25px; }
        
        .section { background: #232323; padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #333; }
        .section h3 { font-size: 1rem; margin-top: 0; color: #ddd; border-bottom: 1px solid #444; padding-bottom: 8px; }
        
        input[type="text"] { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #444; background: #111; color: white; box-sizing: border-box; margin-bottom: 10px; }
        input[type="file"] { margin: 10px 0; width: 100%; color: #bbb; font-size: 0.85rem; }
        
        button { border: none; padding: 12px; border-radius: 5px; cursor: pointer; font-weight: bold; width: 100%; font-size: 0.95rem; transition: 0.3s; margin-top: 5px; }
        .btn-normal { background-color: #607D8B; color: white; }
        .btn-normal:hover { background-color: #455A64; }
        .btn-auto { background-color: #4CAF50; color: white; }
        .btn-auto:hover { background-color: #45a049; }
        
        #result-container { margin-top: 20px; display: none; padding: 15px; background: #3d3d3d; border-radius: 10px; border: 1px solid #555; }
        #id-display { font-size: 1.4rem; color: #ffd700; font-weight: bold; display: block; margin-bottom: 10px; letter-spacing: 2px; }
        .btn-copy { background-color: #2196F3; color: white; padding: 6px 12px; width: auto; font-size: 0.8rem; }
        
        .status-msg { font-size: 0.8rem; color: #888; margin-top: 15px; }
    </style>
</head>
<body>
    <div class="card">
        <h2>üì± Mine City</h2>
        <p class="sub-title">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏π‡∏õ‡∏ï‡∏¥‡∏î‡∏ö‡∏±‡∏ï‡∏£ [ ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏ô‡∏≤‡∏î 1:1 ]</p>
        
        <div class="section">
            <h3>[ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÉ‡∏™‡πà‡∏£‡∏π‡∏õ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á No.ID ‡πÉ‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏® ]</h3>
            <input type="file" id="fileNormal" accept="image/*">
            <button class="btn-normal" onclick="handleUpload('normal')">‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏≤‡∏£‡∏´‡∏±‡∏™ ID</button>
        </div>

        <div class="section">
            <h3>[ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏π‡∏õ‡∏ö‡∏±‡∏ï‡∏£ ]</h3>
            <input type="text" id="userIdInput" placeholder="‡∏Å‡∏£‡∏≠‡∏Å No.ID ‡πÉ‡∏ï‡πâ‡∏ö‡∏±‡∏ï‡∏£">
            <input type="file" id="fileAuto" accept="image/*">
            <button class="btn-auto" onclick="handleUpload('auto')">‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏£‡∏π‡∏õ</button>
        </div>

        <div id="result-container">
            <span id="id-display">‡∏£‡∏´‡∏±‡∏™‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏à‡∏∞‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</span>
            <button class="btn-copy" id="copyBtn" onclick="copyId()">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™</button>
        </div>
        
        <p class="status-msg" id="status-text">Server Status: Online ‚úÖ</p>
    </div>

    <script>
        async function handleUpload(type) {
            const statusText = document.getElementById('status-text');
            const resultContainer = document.getElementById('result-container');
            const idDisplay = document.getElementById('id-display');
            const copyBtn = document.getElementById('copyBtn');
            
            let fileInput = (type === 'normal') ? document.getElementById('fileNormal') : document.getElementById('fileAuto');
            let userId = document.getElementById('userIdInput').value;

            if (fileInput.files.length === 0) {
                alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö!");
                return;
            }
            if (type === 'auto' && !userId) {
                alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å UserId ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥!");
                return;
            }

            // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
            idDisplay.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...";
            resultContainer.style.display = "block";
            copyBtn.style.display = "none";
            statusText.innerText = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö Mine City API...";

            const formData = new FormData();
            formData.append('image', fileInput.files[0]);
            if (type === 'auto') formData.append('userId', userId);

            try {
                const response = await fetch('https://mine-city.onrender.com/upload', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();
                
                if (data.success || data.id) {
                    idDisplay.innerText = data.id;
                    copyBtn.style.display = "inline-block";
                    statusText.innerText = (type === 'auto') ? "‚úÖ ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏£‡∏π‡∏õ‡πÉ‡∏ô‡πÄ‡∏Å‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!" : "‚úÖ ‡πÑ‡∏î‡πâ‡∏£‡∏´‡∏±‡∏™ ID ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢";
                    if(type === 'auto') alert("‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏£‡∏π‡∏õ‡πÉ‡∏ô‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö!");
                } else {
                    statusText.innerText = "‚ùå Error: " + (data.error || "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î");
                }
            } catch (error) {
                statusText.innerText = "‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ API ‡πÑ‡∏î‡πâ";
                alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Render");
            }
        }

        function copyId() {
            const text = document.getElementById('id-display').innerText;
            navigator.clipboard.writeText(text).then(() => {
                alert("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™ " + text + " ‡πÅ‡∏•‡πâ‡∏ß!");
            });
        }
    </script>
</body>
</html>
